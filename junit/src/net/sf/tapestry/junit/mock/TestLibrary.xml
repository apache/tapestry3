<?xml version="1.0" encoding="UTF-8"?>

<!-- $Id$ -->

<mock-test>
    <context name="junit"/>

  	<servlet name="mock" class="net.sf.tapestry.ApplicationServlet">
  		<init-parameter
  			name="net.sf.tapestry.application-specification"
  			value="/net/sf/tapestry/junit/mock/app/Mock.application"/>
  	</servlet>
  	
  	<request>
	  	
  	  <assert-output name="Page Title">
  	  Mock App Home Page
  	  </assert-output>
  	  	  	
  	  <assert-output name="DirectLink with parameters">
<![CDATA[  	  
  	  <a href="/junit/mock\?service=direct&amp;context=Home/link&amp;sp=2&amp;sp=d3\.5&amp;sp=Hello">
]]>
  	  </assert-output>
  	  	  	
 	  <assert-output-matches name="Page structure" subgroup="1">
<![CDATA[
<(/?\w+)(\s*\w+=".*?")*\s*/?>
]]>
		<match>html</match>
		<match>head</match>
		<match>meta</match>
		<match>title</match>
		<match>/title</match>
		<match>link</match>
		<match>/head</match>
		<match>script</match>
		<match>/script</match>
		<match>script</match>
		<match>/script</match>
		<match>body</match>	
		
		<!-- Generated by the ServiceLink -->
		
		<match>a</match>
		<match>/a</match>
		
		<!-- This is generated by the InspectorButton -->
		
		<match>div</match>
		<match>a</match>
		<match>img</match>
		<match>/a</match>
		<match>/div</match>
		
		<match>/body</match>
		<match>/html</match>		
	  </assert-output-matches>
  	  	  
 
  </request>
  
  <request>
  	<parameter name="service" value="direct"/>
  	<parameter name="context" value="Home/link"/>
  	<parameter name="sp">
  		<value>2</value>
  		<value>d3.5</value>
  		<value>Hello</value>
  	</parameter>
		
	<assert-output-matches name="Cells" subgroup="1">
<![CDATA[
<td>(.*?)</td>
]]>
		<match>0</match>
		<match>java.lang.Integer</match>
		<match>2</match>
		
		<match>1</match>
		<match>java.lang.Double</match>
		<match>3.5</match>
		
		<match>2</match>
		<match>java.lang.String</match>
		<match>Hello</match>
	
	</assert-output-matches>
	
  	  <assert-output name="PageLink (for library page).">
<![CDATA[  	  
  	  <a href="/junit/mock\?service=page&amp;context=lib:Dumper">
]]>
  	  </assert-output>	
	
	<assert name="HttpSession created" expression="request.session != null"/>
	
  </request>
  
  <!-- Click the "refresh" link and check that the persistent state is still there. -->
  
  <request>
  	<parameter name="service" value="page"/>
  	<parameter name="context" value="lib:Dumper"/>
  	
  	<assert-output-matches name="Cells (after refresh)" subgroup="1">
<![CDATA[
<td>(.*?)</td>
]]>
		<match>0</match>
		<match>java.lang.Integer</match>
		<match>2</match>
		
		<match>1</match>
		<match>java.lang.Double</match>
		<match>3.5</match>
		
		<match>2</match>
		<match>java.lang.String</match>
		<match>Hello</match>
	
	</assert-output-matches>
	
  </request>
  
  <request>
  	<parameter name="service" value="page"/>
  	<parameter name="context" value="lib:Properties"/>
  	
  	<assert-output-matches name="Page properties" subgroup="1">
<![CDATA[
<td>(.*?)</td>
]]>
		<match>Name</match>
		<match>lib:Properties</match>
		
		<match>Page Name</match>
		<match>Properties</match>
		
	</assert-output-matches>
	
  </request>	
  	
</mock-test>
<?xml version="1.0"?>

<!-- $Id$ -->

<!-- Special build script used when creating new Tapestry releases. 

	 Copy this file and a copy of build.properties to a temporary directory
	 and execute "ant -emacs setup build" using JDK 1.3.
	 
	 Be sure to have a complete build.properties and environment, including
	 the necessary settings and packages for generating documentation
	 (i.e., settings for "fop.dir" and "clover.dir").
	 
	 Generates release distributions into the current directory.
	 
	 -->

<project name="Tapestry Export" default="build">

	<!-- This can be changed to build a historical release, or
		 to build a branch release. -->
		 
	<property name="tag" value="HEAD"/>
	
	<property name="export.dir" value="export"/>
	<property name="module" value="jakarta-tapestry"/>
	<property name="work.dir" value="${export.dir}/${module}"/>
	
	<target name="setup" description="Sets up the directory, gets the files via CVS.">
		<delete dir="${export.dir}" quiet="true"/>
		<mkdir dir="${export.dir}"/>
		<cvs command="-z3 export"
			tag="${tag}" package="${module}"
			dest="${export.dir}"  
			cvsroot=":pserver:anoncvs@cvs.apache.org:/home/cvspublic"/>
			
		<copy todir="${work.dir}/ext-dist">
			<fileset dir="${ext.dist.src.dir}>
				<include name="*.jar"/>
				<include name="*.zip"/>
			</fileset>	
		</copy>
	</target>
	
	
	<target name="build" description="Builds the distribution.">
		<copy file="build.properties"
			todir="${work.dir}/config"/>
		<ant inheritAll="false" dir="${work.dir}" target="dist"/>
		<copy todir=".">
		  <fileset dir="${work.dir}/dist">
		    <include name="*.tar.gz"/>
	        </fileset>
	      </copy>
	</target>
	
</project>

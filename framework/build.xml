<?xml version="1.0"?>
<!-- $Id$ -->
<project name="Tapestry Framework" default="install">

  <property name="root.dir" value=".."/>
  <property file="${root.dir}/config/Version.properties"/>
  <property file="${root.dir}/config/common.properties"/>
  
  <path id="project.class.path">
    <pathelement location="${lib.ext.dir}/ejb.jar"/>
    <pathelement location="${lib.ext.dir}/javax.servlet.jar"/>
    <pathelement location="${lib.ext.dir}/log4j-core.jar"/>
    <pathelement location="${lib.ext.dir}/javax.xml.jaxp.jar"/>
    <pathelement location="${lib.ext.dir}/org.apache.crimson.jar"/>
    <pathelement location="${lib.ext.dir}/org.mortbay.jetty.jar"/>
  </path>
  
  <target name="init">
    <mkdir dir="${classes.dir}"/>
  </target>
  
  <target name="clean">
    <delete dir="${classes.dir}"/>
  </target>
  
  <target name="compile" depends="init" description="Compile all classes in the framework.">
    <javac srcdir="${src.dir}" destdir="${classes.dir}" debug="on" target="1.1">
      <classpath refid="project.class.path"/>
    </javac>
  </target>
  
  <target name="install" depends="compile" description="Compile all classes and build the installed JAR including all package resources.">
   <copy file="${root.dir}/config/Version.properties"
      	todir="${classes.dir}/net/sf/tapestry"/>
 
   <jar jarfile="${framework.jar}">
      <fileset dir="${classes.dir}"/>
      <fileset dir="${src.dir}">
        <include name="**/*.jwc"/>
        <include name="**/*.html"/>
        <include name="**/*.gif"/>
        <include name="**/*.dtd"/>
        <include name="**/*.script"/>
        <include name="**/*.properties"/>
        <include name="**/*.css"/>
        <include name="**/*.swf"/>
        <include name="**/*.js"/>
        <exclude name="**/package.html"/>
      </fileset>
    </jar>
  </target>
</project>

